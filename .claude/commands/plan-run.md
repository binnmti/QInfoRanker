---
description: プランのタスクを順次実行し、結果を記録する
---

# プラン実行

プランフォルダ内のタスクを順次実行し、結果を記録します。

## 重要原則

- **ノンストップ実行**: 確認なしで全タスクを完了まで実行
- **コンテキスト節約**: 詳細はタスクファイルに記録、親では簡潔に
- **失敗時のみ停止**: ブロック/失敗時のみユーザーに報告

## 使い方

```
/plan-run doc/plans/feature-2025-01-improvements
```

引数なしの場合、`doc/plans/` 内の最新プランを自動選択。

## 実行手順

### Step 1: ブランチ切り替えと開始

1. `README.md` を読み込み、ブランチ名とタスク一覧を把握
2. **ブランチに切り替え**（未作成なら作成）
   ```bash
   git checkout {branch-name} || git checkout -b {branch-name}
   ```
3. 進捗を簡潔に表示して即座に実行開始

### Step 2: タスク実行（サブエージェント）

`Task` ツール（general-purpose）で実行：

```
以下のタスクを実行してください。

## タスクファイル
{タスクファイルの内容}

## 開発原則
CLAUDE.mdの開発原則に従ってください。

## 実行後の必須作業
1. タスクファイルの「## 実装内容」「## テスト」のチェックボックスを全て [x] にする
2. 「## 実行結果」セクションにステータス・変更ファイル・コミットハッシュを記録

## 完了条件
- チェックリストを全て完了
- `dotnet build` 成功
- `dotnet test` 成功

## 報告形式（簡潔に）
- ステータス: completed / blocked / failed
- 変更ファイル: リスト
```

### Step 3: レビュー

コミット前に `/local-review` を実行：
- 「重大」「推奨」の指摘があれば修正
- 最大3回ループ

### Step 4: コミット

```bash
git add {変更ファイル}
git commit -m "<type>: <description>

Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>"
```

### Step 5: README.md 更新

タスク完了後、README.md の進捗チェックリストを更新：
```markdown
- [x] task-01 完了
```

### Step 6: 次のタスクへ

- 成功: Step 2 に戻り次のタスクを実行
- 失敗/ブロック: ユーザーに報告

### Step 7: プラン完了

全タスク完了後：

1. `dotnet test` で全テスト通過を確認
2. 新機能があればテストを追加（サブエージェントで実行）
3. README.md の全チェックボックスを更新
4. 完了報告

## 出力形式

**タスク完了時:**
```
## タスク {番号} 完了 → 次: {次のタスク名}
```

**プラン完了時:**
```
## プラン完了: {プラン名}
完了タスク: N / N
```

## 注意事項

- 疑問は plan-new で解決済みのこと
- サブエージェントがチェックボックスを [x] に更新
- サブエージェントが実行結果セクションを記録
- 依存関係を無視して先のタスクを実行しない
